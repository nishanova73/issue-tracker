{% extends 'base.html' %}
{% block title %}Project {{project.pk}}{% endblock %}
{% block nav %}
    {% if not user.is_authenticated %}
{{pass}}
    {% else %}
        <li class="nav-item">
            <a class="nav-link" href="{% url 'webapp:project_add' %}">Create project</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{% url 'webapp:project_task_add' project.pk %}">Add Task</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{% url 'webapp:project_update' project.pk %}">Edit</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{% url 'webapp:project_delete' project.pk %}">Delete</a>
        </li>
{% endif %}
{% endblock %}
{% block content %}
    <h1>{{ project.title }}</h1>
    <h2>{{ project.description }}</h2>
    <p>{{ project.date_started }}</p>
    <p>{{ project.date_finished }}</p>
<h3>Tasks</h3>

    {% for task in project.tasks.all %}
        <span>{{ forloop.counter }}</span>
        <h3>{{ task.description }}</h3>
        {% if not user.is_authenticated %}
            <a href='{{ task.get_absolute_url }}'>Show the task🔓</a>
        {% else %}
        <p>
            <a href='{{ task.get_absolute_url }}'>Show the task🔓</a>
            {% if perms.webapp.change_task %}
                <a href='{% url "webapp:task_update" task.pk %}'>Edit the task📝</a>
            {% endif %}
            {% if perms.webapp.delete_task %}
                <a href='{% url "webapp:task_delete" task.pk %}'>Delete the task✂️</a>
            {% endif %}
        </p>
        {% endif %}
    {% endfor %}

<h3>Users</h3>
    {% for user in project_users %}<a href="{% url 'accounts:user-profile' user.pk %}">{{ user }}</a>
        {% if perms.auth.delete_user and request.users in project.users.all %}
                <button class="remove_user bi bi-person-x" name="user_id" value="{{ user.pk }}"></button>
                {% endif %}
    {% endfor %}

    {% if is_paginated %}
            {% include 'partial/pagination.html' %}
    {% endif %}
{% endblock %}